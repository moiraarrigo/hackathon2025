<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fun Math Learning Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            text-align: center;
            padding: 10px 0;
            font-size: 0.9em;
            color: #666;
            border-top: 1px solid rgba(0,0,0,0.1);
            z-index: 50;
        }

        .footer a {
            color: #ff6b6b;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 10px 60px 10px;
        }

        .accessibility-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 15px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-weight: bold;
        }

        .accessibility-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .info-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .info-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .info-page {
            display: none;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            text-align: center;
            max-height: 80vh;
            overflow-y: auto;
        }

        .info-page.active {
            display: block;
        }

        .info-title {
            color: #ff6b6b;
            font-size: 2em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .info-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
            border: 3px solid #e0e6ff;
        }

        .info-section h3 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .visual-example {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .counter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .example-counter {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .example-counter.red { background-color: #ff6b6b; }
        .example-counter.blue { background-color: #4ecdc4; }
        .example-counter.green { background-color: #96ceb4; }
        .example-counter.yellow { background-color: #feca57; }
        .example-counter.purple { background-color: #ff9ff3; }

        .math-symbol {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .back-button {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 30px;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 20px;
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        .game-container.hidden {
            display: none;
        }

        .start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 50px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .start-screen.hidden {
            display: none;
        }

        .start-logo {
            max-width: 400px;
            width: 80%;
            height: auto;
            margin-bottom: 40px;
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .start-title {
            color: #ff6b6b;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .start-subtitle {
            color: #666;
            font-size: 1.3em;
            margin-bottom: 40px;
        }

        .mode-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }

        .start-mode-button {
            padding: 20px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .start-mode-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        .beginner-button {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .intermediate-button {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
        }

        .logo {
            max-width: 150px;
            height: auto;
            margin-bottom: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .title {
            color: #ff6b6b;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .mode-button {
            padding: 12px 24px;
            border: none;
            border-radius: 20px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #e0e6ff;
            color: #333;
        }

        .mode-button.active {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            transform: scale(1.05);
        }

        .mode-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .score-board {
            display: none;
        }

        .question-area {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 15px;
            border: 3px solid #e0e6ff;
        }

        .question-text {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
        }

        .math-problem {
            font-size: 3em;
            font-weight: bold;
            color: #333;
            margin: 20px 0 40px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            display: block;
            width: 100%;
        }

        .visual-example {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
            padding: 25px;
            background: rgba(248, 249, 255, 0.9);
            border-radius: 15px;
            border: 2px solid #e0e6ff;
            clear: both;
            width: 100%;
        }

        .objects-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            min-height: 200px;
            align-items: center;
        }

        .shape {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .square {
            border-radius: 10px;
        }

        .triangle {
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-bottom: 52px solid;
            border-radius: 0;
            box-shadow: none;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .numbers-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .line-break {
            flex-basis: 100%;
            height: 0;
        }

        .number-button {
            width: 60px;
            height: 60px;
            border: none;
            border-radius: 15px;
            font-size: 1.8em;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .number-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .number-button:active {
            transform: translateY(0);
        }

        .finish-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 1.1em;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .finish-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .summary-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .summary-modal.active {
            display: flex;
        }

        .summary-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .summary-title {
            color: #ff6b6b;
            font-size: 2.2em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .summary-stats {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            font-size: 1.2em;
        }

        .stat-label {
            font-weight: bold;
            color: #333;
        }

        .stat-value {
            font-weight: bold;
            color: #ff6b6b;
        }

        .summary-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .summary-button {
            padding: 15px 25px;
            border: none;
            border-radius: 20px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-again-button {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .new-mode-button {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
        }

        .summary-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .hint-button {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 1.1em;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            margin: 15px 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .hint-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .hint-button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .pair-group {
            display: flex;
            gap: 5px;
            padding: 8px;
            border: 2px dashed #f39c12;
            border-radius: 10px;
            margin: 5px;
            background: rgba(243, 156, 18, 0.1);
        }

        .feedback {
            font-size: 1.3em;
            font-weight: bold;
            margin: 20px 0;
            min-height: 30px;
        }

        .correct {
            color: #27ae60;
        }

        .incorrect {
            color: #e74c3c;
        }

        .attempts {
            color: #f39c12;
            font-size: 1.1em;
            margin: 10px 0;
        }

        .next-button {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .next-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .celebration {
            font-size: 3em;
            animation: celebrate 1s ease-in-out;
        }

        @keyframes celebrate {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="start-screen" id="startScreen">
        <img src="mathmaties-logo.png" alt="mathmaties logo" class="start-logo">
        <h1 class="start-title">Welcome to mathmaties!</h1>
        <p class="start-subtitle">Choose your learning level:</p>
        
        <div class="mode-selection">
            <button class="start-mode-button beginner-button" onclick="startGame('beginner')">
                🔢 Beginner - Counting Fun!
            </button>
            <button class="start-mode-button intermediate-button" onclick="startGame('intermediate')">
                ➕➖ Intermediate - Plus & Minus!
            </button>
        </div>
    </div>

    <button class="accessibility-button" onclick="toggleColorBlindMode()" title="Toggle Color Blind Safe Colors" style="display: none;">🎨 Colors</button>
    <button class="info-button" onclick="showInfo()" title="How to Play" style="display: none;">ℹ️</button>
    
    <div class="game-container hidden" id="gameContainer">
        <img src="mathmaties-logo.png" alt="mathmaties logo" class="logo">
        
        <div class="score-board">
            <div>Mode: <span id="currentMode">Beginner</span></div>
            <div>Correct Answers: <span id="score">0</span></div>
            <div>Total Questions: <span id="total">0</span></div>
        </div>

        <div class="question-area">
            <div class="question-text" id="question">Count the objects below!</div>
            <div class="objects-container" id="objects"></div>
        </div>

        <div class="feedback" id="feedback"></div>
        <div class="attempts" id="attempts"></div>

        <button class="hint-button" id="hintButton" onclick="showHint()" style="display: none;">
            💡 Hint: Group in Pairs
        </button>

        <div class="numbers-container" id="numbers">
            <!-- Number buttons will be generated here -->
        </div>

        <button class="next-button" id="nextButton" onclick="nextQuestion()" style="display: none;">
            Next Question! 🚀
        </button>
    </div>

    <button class="finish-button" id="finishButton" onclick="showSummary()" style="display: none;">
        🏁 Finish Session
    </button>

    <div class="info-page" id="infoPage">
        <h1 class="info-title">📚 How to Play mathmaties! 📚</h1>
        
        <div class="info-section">
            <h3>🔢 Beginner Mode - Counting</h3>
            <p>Count the colorful shapes and click the correct number!</p>
            <div class="visual-example">
                <div class="counter-group">
                    <div class="example-counter red"></div>
                    <div class="example-counter blue"></div>
                    <div class="example-counter green"></div>
                </div>
                <div class="math-symbol">=</div>
                <div class="math-symbol">3</div>
            </div>
            <p>Count each shape: 1, 2, 3... then click the number 3!</p>
        </div>

        <div class="info-section">
            <h3>➕ Plus - Putting Things Together</h3>
            <p>Plus means putting groups together!</p>
            
            <div class="visual-example">
                <div class="counter-group">
                    <div class="example-counter red"></div>
                    <div class="example-counter red"></div>
                </div>
                <div class="math-symbol">+</div>
                <div class="counter-group">
                    <div class="example-counter blue"></div>
                    <div class="example-counter blue"></div>
                    <div class="example-counter blue"></div>
                </div>
                <div class="math-symbol">=</div>
                <div class="counter-group">
                    <div class="example-counter red"></div>
                    <div class="example-counter red"></div>
                    <div class="example-counter blue"></div>
                    <div class="example-counter blue"></div>
                    <div class="example-counter blue"></div>
                </div>
            </div>
            <p><strong>2 + 3 = 5</strong></p>
            <p>Start with 2 red circles, add 3 blue circles, and you get 5 circles!</p>
        </div>

        <div class="info-section">
            <h3>➖ Minus - Taking Things Away</h3>
            <p>Minus means taking some things away!</p>
            
            <div class="visual-example">
                <div class="counter-group">
                    <div class="example-counter green"></div>
                    <div class="example-counter green"></div>
                    <div class="example-counter green"></div>
                    <div class="example-counter green"></div>
                    <div class="example-counter green"></div>
                </div>
                <div class="math-symbol">-</div>
                <div class="counter-group">
                    <div class="example-counter yellow"></div>
                    <div class="example-counter yellow"></div>
                </div>
                <div class="math-symbol">=</div>
                <div class="counter-group">
                    <div class="example-counter green"></div>
                    <div class="example-counter green"></div>
                    <div class="example-counter green"></div>
                </div>
            </div>
            <p><strong>5 - 2 = 3</strong></p>
            <p>Start with 5 green circles, take away 2, and you have 3 circles left!</p>
        </div>

        <div class="info-section">
            <h3>🎯 Tips to Help You</h3>
            <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
                <li>Take your time to count</li>
                <li>Use your fingers to help</li>
                <li>For plus: count the first group, then keep counting with the second group</li>
                <li>For minus: start with the big number and count backwards</li>
                <li>You get 3 tries for each question - it's okay to make mistakes!</li>
                <li>Keep trying! 🌟</li>
            </ul>
        </div>

        <button class="back-button" onclick="hideInfo()">Back to Game! 🚀</button>
    </div>

    <div class="summary-modal" id="summaryModal">
        <div class="summary-content">
            <h2 class="summary-title">🎉 Session Complete! 🎉</h2>
            
            <div class="summary-stats" id="summaryStats">
                <!-- Stats will be populated by JavaScript -->
            </div>
            
            <div class="summary-buttons">
                <button class="summary-button play-again-button" onclick="playAgain()">
                    🔄 Play Again
                </button>
                <button class="summary-button new-mode-button" onclick="chooseNewMode()">
                    🎮 Choose New Mode
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentAnswer = 0;
        let score = 0;
        let totalQuestions = 0;
        let attemptsLeft = 3;
        let gameActive = true;
        let currentMode = 'beginner';
        let firstNumber = 0;
        let secondNumber = 0;
        let colorBlindMode = false;
        let hintUsed = false;
        
        // Session tracking
        let sessionStats = {
            correct: 0,
            incorrect: 0,
            hintsUsed: 0,
            startTime: null,
            mode: ''
        };

        // Regular color palette
        const colors = [
            '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57',
            '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff9f43'
        ];

        // Color blind safe palette (high contrast, distinct patterns, no white)
        const colorBlindSafeColors = [
            '#000000', '#2E8B57', '#FF6347', '#4169E1', '#FFD700',
            '#8A2BE2', '#FF1493', '#00CED1', '#32CD32', '#DC143C'
        ];

        const shapes = ['circle', 'square', 'triangle'];

        function getRandomColor() {
            const currentColors = colorBlindMode ? colorBlindSafeColors : colors;
            return currentColors[Math.floor(Math.random() * currentColors.length)];
        }

        function getRandomShape() {
            return shapes[Math.floor(Math.random() * shapes.length)];
        }

        function showVisualSolution() {
            const objectsContainer = document.getElementById('objects');
            
            // Find and update the math problem to show the complete equation
            const mathProblem = objectsContainer.querySelector('.math-problem');
            if (mathProblem) {
                const operation = mathProblem.textContent.includes('+') ? '+' : '-';
                mathProblem.textContent = `${firstNumber} ${operation} ${secondNumber} = ${currentAnswer}`;
                mathProblem.style.color = '#27ae60'; // Green color for correct answer
            }
            
            // Find the visual example and update it to show the solution
            const visualExample = objectsContainer.querySelector('.visual-example');
            if (visualExample) {
                visualExample.innerHTML = ''; // Clear existing content
                
                if (mathProblem.textContent.includes('+')) {
                    // Addition: Show first group + second group = combined result
                    
                    // First group
                    const firstGroup = document.createElement('div');
                    firstGroup.className = 'counter-group';
                    for (let i = 0; i < firstNumber; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('red');
                        firstGroup.appendChild(counter);
                    }
                    
                    // Plus symbol
                    const plusSymbol = document.createElement('div');
                    plusSymbol.className = 'math-symbol';
                    plusSymbol.textContent = '+';
                    
                    // Second group
                    const secondGroup = document.createElement('div');
                    secondGroup.className = 'counter-group';
                    for (let i = 0; i < secondNumber; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('blue');
                        secondGroup.appendChild(counter);
                    }
                    
                    // Equals symbol
                    const equalsSymbol = document.createElement('div');
                    equalsSymbol.className = 'math-symbol';
                    equalsSymbol.textContent = '=';
                    
                    // Combined result group
                    const resultGroup = document.createElement('div');
                    resultGroup.className = 'counter-group';
                    // Show red counters first, then blue counters
                    for (let i = 0; i < firstNumber; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('red');
                        resultGroup.appendChild(counter);
                    }
                    for (let i = 0; i < secondNumber; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('blue');
                        resultGroup.appendChild(counter);
                    }
                    
                    visualExample.appendChild(firstGroup);
                    visualExample.appendChild(plusSymbol);
                    visualExample.appendChild(secondGroup);
                    visualExample.appendChild(equalsSymbol);
                    visualExample.appendChild(resultGroup);
                    
                } else {
                    // Subtraction: Show original group - taken away = remaining
                    
                    // Original group
                    const originalGroup = document.createElement('div');
                    originalGroup.className = 'counter-group';
                    for (let i = 0; i < firstNumber; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('green');
                        originalGroup.appendChild(counter);
                    }
                    
                    // Minus symbol
                    const minusSymbol = document.createElement('div');
                    minusSymbol.className = 'math-symbol';
                    minusSymbol.textContent = '-';
                    
                    // Taken away group
                    const takenGroup = document.createElement('div');
                    takenGroup.className = 'counter-group';
                    for (let i = 0; i < secondNumber; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('yellow');
                        counter.style.opacity = '0.7';
                        takenGroup.appendChild(counter);
                    }
                    
                    // Equals symbol
                    const equalsSymbol = document.createElement('div');
                    equalsSymbol.className = 'math-symbol';
                    equalsSymbol.textContent = '=';
                    
                    // Remaining group
                    const remainingGroup = document.createElement('div');
                    remainingGroup.className = 'counter-group';
                    for (let i = 0; i < currentAnswer; i++) {
                        const counter = document.createElement('div');
                        counter.className = 'example-counter';
                        counter.style.backgroundColor = getCounterColor('green');
                        remainingGroup.appendChild(counter);
                    }
                    
                    visualExample.appendChild(originalGroup);
                    visualExample.appendChild(minusSymbol);
                    visualExample.appendChild(takenGroup);
                    visualExample.appendChild(equalsSymbol);
                    visualExample.appendChild(remainingGroup);
                }
                
                // Add a subtle animation to highlight the solution
                visualExample.style.animation = 'celebrate 1s ease-in-out';
            }
        }

        function showHint() {
            if (currentMode !== 'beginner' || hintUsed) return;
            
            hintUsed = true;
            sessionStats.hintsUsed++;
            const objectsContainer = document.getElementById('objects');
            const hintButton = document.getElementById('hintButton');
            
            // Get all existing shapes
            const shapes = Array.from(objectsContainer.children);
            
            // Clear container
            objectsContainer.innerHTML = '';
            
            // Group shapes into pairs
            for (let i = 0; i < shapes.length; i += 2) {
                const pairGroup = document.createElement('div');
                pairGroup.className = 'pair-group';
                
                // Add first shape of the pair
                pairGroup.appendChild(shapes[i]);
                
                // Add second shape if it exists
                if (i + 1 < shapes.length) {
                    pairGroup.appendChild(shapes[i + 1]);
                }
                
                objectsContainer.appendChild(pairGroup);
            }
            
            // Update hint button
            hintButton.textContent = '✅ Hint Used';
            hintButton.disabled = true;
            
            // Update question text to help with counting
            const questionElement = document.getElementById('question');
            if (currentAnswer % 2 === 0) {
                questionElement.textContent = `Count the pairs! Each pair = 2. How many objects total?`;
            } else {
                questionElement.textContent = `Count the pairs plus the single one! Each pair = 2. How many objects total?`;
            }
        }

        function showSummary() {
            const modal = document.getElementById('summaryModal');
            const statsContainer = document.getElementById('summaryStats');
            
            // Calculate session duration
            const endTime = new Date();
            const duration = Math.round((endTime - sessionStats.startTime) / 1000 / 60); // minutes
            
            // Calculate accuracy
            const totalAnswered = sessionStats.correct + sessionStats.incorrect;
            const accuracy = totalAnswered > 0 ? Math.round((sessionStats.correct / totalAnswered) * 100) : 0;
            
            // Generate stats HTML
            statsContainer.innerHTML = `
                <div class="stat-item">
                    <span class="stat-label">Mode Played:</span>
                    <span class="stat-value">${sessionStats.mode.charAt(0).toUpperCase() + sessionStats.mode.slice(1)}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">✅ Correct Answers:</span>
                    <span class="stat-value">${sessionStats.correct}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">❌ Incorrect Answers:</span>
                    <span class="stat-value">${sessionStats.incorrect}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">🎯 Accuracy:</span>
                    <span class="stat-value">${accuracy}%</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">💡 Hints Used:</span>
                    <span class="stat-value">${sessionStats.hintsUsed}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">⏱️ Time Played:</span>
                    <span class="stat-value">${duration} minute${duration !== 1 ? 's' : ''}</span>
                </div>
            `;
            
            modal.classList.add('active');
        }

        function playAgain() {
            // Reset session stats
            sessionStats = {
                correct: 0,
                incorrect: 0,
                hintsUsed: 0,
                startTime: new Date(),
                mode: currentMode
            };
            
            // Reset game stats
            score = 0;
            totalQuestions = 0;
            
            // Hide modal and restart game
            document.getElementById('summaryModal').classList.remove('active');
            updateScore();
            generateQuestion();
            createNumberButtons();
        }

        function chooseNewMode() {
            // Hide modal and game, show start screen
            document.getElementById('summaryModal').classList.remove('active');
            document.getElementById('gameContainer').classList.add('hidden');
            document.querySelector('.accessibility-button').style.display = 'none';
            document.querySelector('.info-button').style.display = 'none';
            document.getElementById('finishButton').style.display = 'none';
            document.getElementById('startScreen').classList.remove('hidden');
        }

        function toggleColorBlindMode() {
            colorBlindMode = !colorBlindMode;
            
            // Update button text to show current state
            const button = document.querySelector('.accessibility-button');
            button.textContent = colorBlindMode ? '🎨 Standard' : '🎨 Colors';
            
            // Regenerate current question with new colors
            generateQuestion();
            createNumberButtons();
        }

        function getCounterColor(type) {
            if (colorBlindMode) {
                switch(type) {
                    case 'red': return '#000000'; // Black
                    case 'blue': return '#4169E1'; // Royal Blue
                    case 'green': return '#2E8B57'; // Sea Green
                    case 'yellow': return '#FFD700'; // Gold
                    case 'purple': return '#8A2BE2'; // Blue Violet
                    default: return '#000000';
                }
            } else {
                switch(type) {
                    case 'red': return '#ff6b6b';
                    case 'blue': return '#4ecdc4';
                    case 'green': return '#96ceb4';
                    case 'yellow': return '#feca57';
                    case 'purple': return '#ff9ff3';
                    default: return '#ff6b6b';
                }
            }
        }

        function startGame(mode) {
            // Hide start screen
            document.getElementById('startScreen').classList.add('hidden');
            
            // Show game container and control buttons
            document.getElementById('gameContainer').classList.remove('hidden');
            document.querySelector('.accessibility-button').style.display = 'block';
            document.querySelector('.info-button').style.display = 'block';
            document.getElementById('finishButton').style.display = 'block';
            
            // Initialize session tracking
            sessionStats = {
                correct: 0,
                incorrect: 0,
                hintsUsed: 0,
                startTime: new Date(),
                mode: mode
            };
            
            // Set the selected mode
            setMode(mode);
        }

        function showInfo() {
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('infoPage').classList.add('active');
        }

        function hideInfo() {
            document.getElementById('gameContainer').style.display = 'block';
            document.getElementById('infoPage').classList.remove('active');
        }

        function setMode(mode) {
            currentMode = mode;
            
            // Update mode display
            document.getElementById('currentMode').textContent = 
                mode === 'beginner' ? 'Beginner' : 'Intermediate';
            
            generateQuestion();
            createNumberButtons();
        }

        function generateQuestion() {
            attemptsLeft = 3;
            gameActive = true;
            hintUsed = false;
            
            const objectsContainer = document.getElementById('objects');
            const feedbackElement = document.getElementById('feedback');
            const attemptsElement = document.getElementById('attempts');
            const nextButton = document.getElementById('nextButton');
            const hintButton = document.getElementById('hintButton');
            
            // Clear previous content
            objectsContainer.innerHTML = '';
            feedbackElement.innerHTML = '';
            attemptsElement.innerHTML = '';
            nextButton.style.display = 'none';
            
            // Show hint button only in beginner mode
            if (currentMode === 'beginner') {
                hintButton.style.display = 'inline-block';
                hintButton.disabled = false;
                hintButton.textContent = '💡 Hint: Group in Pairs';
            } else {
                hintButton.style.display = 'none';
            }
            
            if (currentMode === 'beginner') {
                generateBeginnerQuestion();
            } else {
                generateIntermediateQuestion();
            }
        }

        function generateBeginnerQuestion() {
            currentAnswer = Math.floor(Math.random() * 9) + 1; // 1-9
            
            const objectsContainer = document.getElementById('objects');
            
            // Generate objects
            const selectedShape = getRandomShape();
            for (let i = 0; i < currentAnswer; i++) {
                const shape = document.createElement('div');
                shape.className = `shape ${selectedShape}`;
                
                const color = getRandomColor();
                if (selectedShape === 'triangle') {
                    shape.style.borderBottomColor = color;
                } else {
                    shape.style.backgroundColor = color;
                }
                
                objectsContainer.appendChild(shape);
            }
            
            // Update question text
            document.getElementById('question').textContent = "How many objects do you see?";
        }

        function generateIntermediateQuestion() {
            // Randomly choose between addition and subtraction
            const operation = Math.random() < 0.5 ? 'addition' : 'subtraction';
            
            const objectsContainer = document.getElementById('objects');
            
            if (operation === 'addition') {
                // Generate two numbers that add up to 1-9 (avoiding 0)
                firstNumber = Math.floor(Math.random() * 5) + 1; // 1-5
                secondNumber = Math.floor(Math.random() * (9 - firstNumber)) + 1; // 1 to (9-firstNumber)
                currentAnswer = firstNumber + secondNumber;
                
                // Create math problem display
                const mathProblem = document.createElement('div');
                mathProblem.className = 'math-problem';
                mathProblem.textContent = `${firstNumber} + ${secondNumber} = ?`;
                objectsContainer.appendChild(mathProblem);
                
                // Add a clear separator
                const separator = document.createElement('div');
                separator.style.clear = 'both';
                separator.style.height = '20px';
                objectsContainer.appendChild(separator);
                
                // Create visual representation
                const visualExample = document.createElement('div');
                visualExample.className = 'visual-example';
                
                // First group of counters
                const firstGroup = document.createElement('div');
                firstGroup.className = 'counter-group';
                for (let i = 0; i < firstNumber; i++) {
                    const counter = document.createElement('div');
                    counter.className = 'example-counter';
                    counter.style.backgroundColor = getCounterColor('red');
                    firstGroup.appendChild(counter);
                }
                
                // Plus symbol
                const plusSymbol = document.createElement('div');
                plusSymbol.className = 'math-symbol';
                plusSymbol.textContent = '+';
                
                // Second group of counters
                const secondGroup = document.createElement('div');
                secondGroup.className = 'counter-group';
                for (let i = 0; i < secondNumber; i++) {
                    const counter = document.createElement('div');
                    counter.className = 'example-counter';
                    counter.style.backgroundColor = getCounterColor('blue');
                    secondGroup.appendChild(counter);
                }
                
                // Equals symbol
                const equalsSymbol = document.createElement('div');
                equalsSymbol.className = 'math-symbol';
                equalsSymbol.textContent = '=';
                
                // Question mark
                const questionMark = document.createElement('div');
                questionMark.className = 'math-symbol';
                questionMark.textContent = '?';
                
                visualExample.appendChild(firstGroup);
                visualExample.appendChild(plusSymbol);
                visualExample.appendChild(secondGroup);
                visualExample.appendChild(equalsSymbol);
                visualExample.appendChild(questionMark);
                
                objectsContainer.appendChild(visualExample);
                
                // Update question text
                document.getElementById('question').textContent = "Count all the circles to find the answer!";
            } else {
                // Generate subtraction problem (ensure result is not negative and not zero)
                firstNumber = Math.floor(Math.random() * 9) + 2; // 2-10
                secondNumber = Math.floor(Math.random() * (firstNumber - 1)) + 1; // 1 to (firstNumber-1)
                currentAnswer = firstNumber - secondNumber;
                
                // Create math problem display
                const mathProblem = document.createElement('div');
                mathProblem.className = 'math-problem';
                mathProblem.textContent = `${firstNumber} - ${secondNumber} = ?`;
                objectsContainer.appendChild(mathProblem);
                
                // Add a clear separator
                const separator = document.createElement('div');
                separator.style.clear = 'both';
                separator.style.height = '20px';
                objectsContainer.appendChild(separator);
                
                // Create visual representation
                const visualExample = document.createElement('div');
                visualExample.className = 'visual-example';
                
                // First group of counters (all green initially)
                const firstGroup = document.createElement('div');
                firstGroup.className = 'counter-group';
                for (let i = 0; i < firstNumber; i++) {
                    const counter = document.createElement('div');
                    counter.className = 'example-counter';
                    counter.style.backgroundColor = getCounterColor('green');
                    firstGroup.appendChild(counter);
                }
                
                // Minus symbol
                const minusSymbol = document.createElement('div');
                minusSymbol.className = 'math-symbol';
                minusSymbol.textContent = '-';
                
                // Second group of counters (showing what to take away)
                const secondGroup = document.createElement('div');
                secondGroup.className = 'counter-group';
                for (let i = 0; i < secondNumber; i++) {
                    const counter = document.createElement('div');
                    counter.className = 'example-counter';
                    counter.style.backgroundColor = getCounterColor('yellow');
                    counter.style.opacity = '0.5'; // Make them semi-transparent to show "taking away"
                    secondGroup.appendChild(counter);
                }
                
                // Equals symbol
                const equalsSymbol = document.createElement('div');
                equalsSymbol.className = 'math-symbol';
                equalsSymbol.textContent = '=';
                
                // Question mark
                const questionMark = document.createElement('div');
                questionMark.className = 'math-symbol';
                questionMark.textContent = '?';
                
                visualExample.appendChild(firstGroup);
                visualExample.appendChild(minusSymbol);
                visualExample.appendChild(secondGroup);
                visualExample.appendChild(equalsSymbol);
                visualExample.appendChild(questionMark);
                
                objectsContainer.appendChild(visualExample);
                
                // Update question text
                document.getElementById('question').textContent = "Solve the equation!";
            }
        }

        function generateQuestion_old() {
            currentAnswer = Math.floor(Math.random() * 10); // 0-9
            attemptsLeft = 3;
            gameActive = true;
            
            const objectsContainer = document.getElementById('objects');
            const feedbackElement = document.getElementById('feedback');
            const attemptsElement = document.getElementById('attempts');
            const nextButton = document.getElementById('nextButton');
            
            // Clear previous content
            objectsContainer.innerHTML = '';
            feedbackElement.innerHTML = '';
            attemptsElement.innerHTML = '';
            nextButton.style.display = 'none';
            
                // Generate objects
            const selectedShape = getRandomShape();
            for (let i = 0; i < currentAnswer; i++) {
                const shape = document.createElement('div');
                shape.className = `shape ${selectedShape}`;
                
                const color = getRandomColor();
                if (selectedShape === 'triangle') {
                    shape.style.borderBottomColor = color;
                } else {
                    shape.style.backgroundColor = color;
                }
                
                objectsContainer.appendChild(shape);
            }
            
            // Update question text
            const questionText = currentAnswer === 0 ? 
                "How many objects do you see? (There might be none!)" : 
                "How many objects do you see?";
            document.getElementById('question').textContent = questionText;
        }

        function createNumberButtons() {
            const numbersContainer = document.getElementById('numbers');
            numbersContainer.innerHTML = '';
            
            // For intermediate mode, show numbers 1-18 (since max sum could be higher)
            // But we'll limit our problems to sums up to 9 for now, so keep 1-18 for flexibility
            const maxNumber = currentMode === 'intermediate' ? 18 : 9;
            
            for (let i = 1; i <= maxNumber; i++) {
                const button = document.createElement('button');
                button.className = 'number-button';
                button.textContent = i;
                button.style.backgroundColor = getRandomColor();
                button.onclick = () => checkAnswer(i);
                numbersContainer.appendChild(button);
                
                // Add line break after button 9 in intermediate mode
                if (currentMode === 'intermediate' && i === 9) {
                    const lineBreak = document.createElement('div');
                    lineBreak.className = 'line-break';
                    numbersContainer.appendChild(lineBreak);
                }
            }
        }

        function checkAnswer(selectedNumber) {
            if (!gameActive) return;
            
            const feedbackElement = document.getElementById('feedback');
            const attemptsElement = document.getElementById('attempts');
            const nextButton = document.getElementById('nextButton');
            
            if (selectedNumber === currentAnswer) {
                // Correct answer
                score++;
                totalQuestions++;
                sessionStats.correct++;
                gameActive = false;
                
                feedbackElement.innerHTML = '<div class="correct celebration">😊 ✅</div>';
                
                // Show visual solution for intermediate mode
                if (currentMode === 'intermediate') {
                    showVisualSolution();
                }
                
                nextButton.style.display = 'inline-block';
                
                updateScore();
            } else {
                // Wrong answer
                attemptsLeft--;
                
                if (attemptsLeft > 0) {
                    feedbackElement.innerHTML = '<div class="incorrect">Try again! You can do it! 💪</div>';
                    attemptsElement.innerHTML = `Attempts left: ${attemptsLeft}`;
                } else {
                    // No attempts left
                    totalQuestions++;
                    sessionStats.incorrect++;
                    gameActive = false;
                    
                    feedbackElement.innerHTML = `<div class="incorrect">Answer: ${currentAnswer}</div>`;
                    nextButton.style.display = 'inline-block';
                    
                    updateScore();
                }
            }
        }

        function updateScore() {
            document.getElementById('score').textContent = score;
            document.getElementById('total').textContent = totalQuestions;
        }

        function nextQuestion() {
            generateQuestion();
            createNumberButtons();
        }

        // Initialize the game (but don't start until mode is selected)
        function initGame() {
            // Game will start when user selects a mode from start screen
            updateScore();
        }

        // Start the game when page loads
        window.onload = initGame;
    </script>

    <footer class="footer">
        © 2025 All rights reserved by <strong>ogiram</strong>
    </footer>

</body>
</html>
